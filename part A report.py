import matplotlib.pyplot as plt

# Data extracted from your table
elements = [654, 681, 951, 1500, 1864, 3015, 4980, 11096, 16452, 24310,
            43968, 84360, 138852, 200380, 392125, 685150]
log_n = [2.815577748, 2.833147112, 2.978180517, 3.176091259, 3.270445908, 3.479287316,
         3.697229343, 4.045166448, 4.216218701, 4.385784959, 4.643136711, 4.926136571,
         5.14255214, 5.301854372, 5.593424532, 5.835785662]
size = [0.011, 0.01, 0.009, 0.008, 0.007, 0.006, 0.005, 0.004, 0.0035, 0.003,
        0.0025, 0.002, 0.0017, 0.0015, 0.0012, 0.001]
c3d8_max_disp = [0.0001676, 0.0001678, 0.0001695, 0.0001703, 0.000171, 0.0001733,
                 0.0001739, 0.0001756, 0.0001763, 0.0001769, 0.0001773, 0.0001777,
                 0.0001779, 0.0001781, 0.0001782, 0.0001783]
c3d8_diff = [0, 0.119331742, 1.013110846, 0.471976401, 0.411039342, 1.34502924,
             0.346220427, 0.977573318, 0.398633257, 0.340328985, 0.22611645,
             0.225606317, 0.11254924, 0.112422709, 0.056148231, 0.056116723]
c3d20_max_disp = [0.0001777, 0.0001778, 0.0001779, 0.000178, 0.0001781, 0.0001782,
                  0.0001783, 0.0001784, 0.0001784, 0.0001784, 0.0001784, 0.0001784,
                  0.0001784, 0.0001784, 0.0001784, 0.0001784]
c3d20_diff = [0, 0.05627462, 0.05624297, 0.056211355, 0.056179775, 0.056148231,
              0.056116723, 0.05608525, 0, 0, 0, 0, 0, 0, 0, 0]

# Set global font size
plt.rcParams.update({'font.size': 14})

# Plotting Max Displacement for C3D8 and C3D20
plt.figure(figsize=(9, 6))
plt.plot(log_n, [disp * 1000 for disp in c3d8_max_disp], label='C3D8', marker='o')
plt.plot(log_n, [disp * 1000 for disp in c3d20_max_disp], label='C3D20', marker='o')
plt.axhline(y=0.185, color='red', linestyle='--', label='Analytical solution')
plt.xlabel('Log(N)')
plt.ylabel('Displacement (mm)')
plt.legend()
plt.grid(True)
plt.show()
